@use "sass:map";

@import './new-settings';
@import './mixins';

$block: #{$fd-namespace}-icon-tab-bar;
$fd-icon-tab-bar-icon-spacing: 0.188rem !default;
$fd-icon-tab-bar-list-padding-right: 1rem !default;
$fd-icon-tab-bar-icon-circle-size: 2.75rem !default;
$fd-icon-tab-bar-icon-separator-size: 1rem !default;
$fd-icon-tab-bar-border-thickness: 0.0625rem !default;
$fd-icon-tab-bar-filter-container-height: 2rem !default;
$fd-icon-tab-bar-single-click-arrow-size: 1rem !default;
$fd-icon-tab-bar-icon-circle-size-compact: 2rem !default;
$fd-icon-tab-bar-multi-click-button-size: 1.5rem !default;
$fd-icon-tab-bar-tablist-border: var(--sapContent_HeaderShadow);
$fd-icon-tab-bar-filter-container-top-offset: 1.625rem !default;
$fd-icon-tab-bar-overflow-button-border-radius: var(--fdIcon_Tab_Bar_Overflow_Button_Border_Radius) !default;
$fd-icon-tab-bar-overflow-button-focus-offset: var(--fdIcon_Tab_Bar_Overflow_Button_Focus_Offset) !default;
$fd-icon-tab-bar-filter-container-top-offset-compact: 1.375rem !default;
$fd-icon-tab-bar-dnd-separator-bar-horizontal-offset: -0.5rem !default;
$fd-icon-tab-bar-dnd-separator-bar-vertical-offset: 0.125rem !default;
$fd-icon-tab-bar-dnd-separator-circle-horizontal-offset: -0.7rem !default;
$fd-icon-tab-bar-dnd-separator-circle-vertical-offset: -0.0625rem !default;
$fd-icon-tab-bar-dnd-separator-circle-size: 0.5rem !default;
$fd-icon-tab-bar-focus-offset: var(--fdIcon_Tab_Bar_Focus_Offset) !default;
$fd-icon-tab-bar-responsive-paddings: (
  'sm': (
    'padding': 1rem
  ),
  'md': (
    'padding': 2rem
  ),
  'lg': (
    'padding': 2rem
  ),
  'xl': (
    'padding': 3rem
  ),
  'xxl': (
    'padding': 3rem
  )
);
$fd-icon-tab-bar-semantic-values: (
  'negative': (
    'icon': '\e1ec',
    'iconColor': var(--sapNegativeElementColor),
    'color': var(--fdIcon_Tab_Bar_Semantic_Color_Negative),
    'badgeColor': var(--fdIcon_Tab_Bar_Semantic_Badge_Color_Negative),
    'backgroundColor': var(--fdIcon_Tab_Bar_Semantic_Background_Color_Negative)
  ),
  'positive': (
    'icon': '\e1c1',
    'iconColor': var(--sapPositiveElementColor),
    'color': var(--fdIcon_Tab_Bar_Semantic_Color_Positive),
    'badgeColor': var(--fdIcon_Tab_Bar_Semantic_Badge_Color_Positive),
    'backgroundColor': var(--fdIcon_Tab_Bar_Semantic_Background_Color_Positive)
  ),
  'critical': (
    'icon': '\e053',
    'iconColor': var(--sapCriticalElementColor),
    'color': var(--fdIcon_Tab_Bar_Semantic_Color_Critical),
    'badgeColor': var(--fdIcon_Tab_Bar_Semantic_Badge_Color_Critical),
    'backgroundColor': var(--fdIcon_Tab_Bar_Semantic_Background_Color_Critical)
  ),
  'informative': (
    'icon': '\e289',
    'iconColor': var(--sapInformativeElementColor),
    'color': var(--fdIcon_Tab_Bar_Semantic_Color_Informative),
    'badgeColor': var(--fdIcon_Tab_Bar_Semantic_Badge_Color_Informative),
    'backgroundColor': var(--fdIcon_Tab_Bar_Semantic_Background_Color_Informative)
  )
);

@mixin fd-icon-tab-bar-selection-bar() {
  position: relative;

  &::after {
    left: 0;
    bottom: 0;
    content: '';
    width: 100%;
    position: absolute;
    display: inline-block;
    border-radius: 0.125rem 0.125rem 0 0;
    transition: all $fd-animation-speed ease-in;
    height: var(--fdIcon_Tab_Bar_Selection_Bar_Height);
    background: var(--fdIconTabBar_Selection_Bar_Color);
  }
}

@mixin fd-icon-tab-bar-set-circle-size($size) {
  width: $size;
  height: $size;
  border-radius: 50%;
}

@mixin fd-icon-tab-bar-reset-icon() {
  content: none;
  margin-inline: 0;
  margin-block: 0;
}

@mixin fd-icon-tab-bar-process-selection-bar-width($iconSize) {
  &::after {
    width: $iconSize + 2 * $fd-icon-tab-bar-icon-spacing;
  }
}

%fd-icon-tab-bar-text {
  @include fd-reset();

  line-height: 1rem;
  white-space: nowrap;
  color: var(--sapContent_LabelColor);
}

%semantic-icon-base {
  speak: none;
  font-size: 0.75rem;
  font-family: SAP-icons;
  -webkit-font-smoothing: antialiased;
  color: var(--fdIconTabBar_Tag_Icon_Color);
  display: var(--fdIcon_Tab_Bar_Semantic_Icon_Display);
}

%semantic-icon-extended {
  margin-inline: 0;
  margin-block: 0;
  bottom: 0;
  width: 0.75rem;
  position: absolute;
}

%semantic-icon-reset {
  &::before {
    @include fd-icon-tab-bar-reset-icon();
  }
}

@mixin fd-tabs-focus($outlineColor: var(--sapContent_FocusColor), $offset: false, $placement: 'after') {
  &::#{$placement} {
    content: '';
    position: absolute;
    inset: 0;
    display: block;
    border: var(--sapContent_FocusWidth) var(--sapContent_FocusStyle) $outlineColor;

    @if $offset {
      @include fd-set-equal-positions($fd-icon-tab-bar-focus-offset);
    }

    @content;
  }
}

@mixin fd-tabs-remove-focus-from-tag() {
  .#{$block}__tag {
    outline: none;

    &::after {
      border: none;
    }
  }
}

@mixin fd-set-navigation-tab-colors($color: var(--sapShell_Navigation_Selected_TextColor)) {
  [class*='sap-icon'] {
    color: $color;
    @content;
  }

  .#{$block}__tag {
    color: $color;
  }
}

@mixin fd-icon-tab-bar-semantic-item() {
  @each $set-name, $set-params in $fd-icon-tab-bar-semantic-values {
    $semantic-icon-margin: 0.5rem;
    $semantic-icon-position: -0.9rem;

    &--#{$set-name} {
      --fdIconTabBar_Badge_Background: #{map.get($set-params, 'badgeColor')};
      --fdIconTabBar_Badge_Background_After: #{map.get($set-params, 'badgeColor')};
      --fdIconTabBar_Tag_Color: #{map.get($set-params, 'color')};
      --fdIconTabBar_Tag_Icon_Color: #{map.get($set-params, 'iconColor')};
      --fdIconTabBar_Tag_Icon_Content: #{map.get($set-params, 'icon')};
      --fdIconTabBar_Icon_Color: #{map.get($set-params, 'color')};
      --fdIconTabBar_Icon_Border_Color: #{map.get($set-params, 'color')};

      .#{$block}__tag {
        &::before {
          @extend %semantic-icon-base;

          margin-inline-end: $semantic-icon-margin;
          content: map.get($set-params, 'icon');
        }

        @include fd-rtl() {
          @extend %semantic-icon-reset;

          &::after {
            @extend %semantic-icon-base;

            margin-inline-end: $semantic-icon-margin;
            content: map.get($set-params, 'icon');
          }
        }
      }

      .#{$block}__tab {
        @include fd-hover() {
          --fdIconTabBar_Tag_Color: #{map.get($set-params, 'color')};
        }

        @include fd-selected() {
          --fdIconTabBar_Selection_Bar_Color: #{map.get($set-params, 'color')};
          --fdIconTabBar_Tag_Color: #{map.get($set-params, 'color')};
          --fdIconTabBar_Icon_Background: #{map.get($set-params, 'backgroundColor')};

          @include fd-hover() {
            --fdIconTabBar_Tag_Color: #{map.get($set-params, 'color')};
          }
        }
      }

      .#{$block}__icon {
        position: relative;

        &::before {
          @extend %semantic-icon-base;
          @extend %semantic-icon-extended;

          right: $semantic-icon-position;
          content: map.get($set-params, 'icon');
        }

        @include fd-rtl() {
          @extend %semantic-icon-reset;

          &::after {
            @extend %semantic-icon-base;
            @extend %semantic-icon-extended;

            right: auto;
            left: $semantic-icon-position;
            content: map.get($set-params, 'icon');
          }
        }
      }
    }
  }
}

@mixin fd-icon-tab-bar-list-item-color($color) {
  .#{$block}__list-item-icon [class*='sap-icon'],
  .#{$block}__list-item-icon[class*='sap-icon'],
  .#{$block}__list-item-title,
  .#{$block}__list-item-counter {
    color: $color;
  }
}

@mixin fd-icon-tab-bar-close-btn-overwrite($size: 1.5rem) {
  @include fd-set-width($size);
  @include fd-set-height($size);

  border-radius: 0.25rem;

  @include fd-focus() {
    &::after {
      border-radius: var(--fdIcon_Tab_Bar_Multi_Click_Button_Focus_Radius);
    }
  }
}

@mixin fd-icon-tab-bar-close-btn-container-overwrite($posRight: 0) {
  @include fd-set-position-right($posRight);
  @include fd-set-width(2rem);

  z-index: 10;
  position: absolute;

  &::before {
    display: none;
  }
}

.#{$block} {
  --fdIconTabBar_Icon_Size: #{$fd-icon-tab-bar-icon-circle-size};
  --fdIconTabBar_Icon_Font_Size: 1.25rem;
  --fdIcon_Tab_Bar_Container_Badge_Size: 0.5rem;

  @include fd-reset();

  &__header {
    @include fd-reset();
    @include fd-flex-vertical-center();

    list-style: none;
    box-shadow: var(--sapContent_HeaderShadow);
    background: var(--sapObjectHeader_Background);
    min-height: 2.75rem;
    position: relative;

    &:has(.#{$block}__item--overflow) {
      overflow: visible;
    }
  }

  &__panel {
    background: var(--sapBackgroundColor);
  }

  &__item {
    @include fd-reset();
    @include fd-icon-tab-bar-semantic-item();
    @include fd-flex-vertical-center();

    margin-inline-end: 2rem;

    &--single-click {
      .#{$block}__tab {
        flex-direction: row;
        align-items: center;

        @include fd-focus() {
          .#{$block}__tab-container {
            @include fd-tabs-remove-focus-from-tag();

            @include fd-tabs-focus(var(--sapContent_FocusColor), true) {
              border-radius: var(--fdIcon_Tab_Bar_Text_Focus_Radius);
            }

            position: relative;
          }

          .#{$block}__badge {
            @include fd-set-position-right(-0.4375rem);

            top: -0.125rem;
          }
        }
      }
    }

    &.#{$block}__item--multi-click {
      @include fd-flex-center();

      position: relative;

      .#{$block}__tab {
        padding-inline: 0.188rem 1.938rem;

        .#{$block}__badge {
          @include fd-set-position-right(1.625rem);
        }

        @include fd-selected() {
          & + .#{$block}__popover .#{$block}__button-container::before {
            --fdIconTabBar_Multi_Click_Separator_Background: var(--sapContent_Selected_ForegroundColor);
          }
        }
      }

      &.#{$block}__item--closable {
        .#{$block}__tab {
          padding-inline: 0.188rem 3.938rem;
        }

        .#{$block}__popover {
          @include fd-set-position-right(2.188rem);
          @include fd-set-width(1.5rem);

          height: 100%;

          .#{$block}__button-container {
            @include fd-set-width(1.5rem);

            &::before {
              display: var(--fdIcon_Tab_Bar_Multi_Click_Button_Separator_Display);
            }
          }
        }
      }
    }

    &.#{$block}__item--closable {
      @include fd-flex-center();

      position: relative;

      .#{$block}__tab {
        padding-inline: 0.188rem 2.188rem;
      }

      .#{$block}__button-container {
        @include fd-icon-tab-bar-close-btn-container-overwrite();
      }
    }

    &--dnd-preview {
      @include fd-flex-center() {
        flex-direction: column;
      }

      background: var(--sapObjectHeader_Background);
      font-size: var(--sapFontSize);
      line-height: var(--sapContent_LineHeight);
      opacity: 0.8;
      z-index: 9999 !important;

      * {
        background: var(--sapObjectHeader_Background);
      }
    }

    &--dnd-hovered {
      background: var(--sapButton_Hover_Background);
      box-shadow: inset 0 0 0 0.125rem var(--sapButton_Hover_BorderColor);

      &.#{$block}__list-item {
        // overriding basic and hover background for list-item
        background: var(--sapButton_Hover_Background) !important;

        .#{$block}__list-link {
          background: none;
        }
      }
    }

    @mixin icon-tab-dnd-separator($is-end: false) {
      position: relative;

      // separator line
      &::before {
        content: '';
        position: absolute;
        top: 0;
        width: 0.125rem;
        height: 100%;
        background: var(--fdIcon_Tab_Bar_Separator_Color);

        @if $is-end {
          @include fd-set-position-right-pseudo($fd-icon-tab-bar-dnd-separator-bar-horizontal-offset);
        } @else {
          @include fd-set-position-left-pseudo($fd-icon-tab-bar-dnd-separator-bar-horizontal-offset);
        }
      }

      // separator circle
      &::after {
        content: '';
        position: absolute;
        top: 0;
        width: $fd-icon-tab-bar-dnd-separator-circle-size;
        height: $fd-icon-tab-bar-dnd-separator-circle-size;
        border-radius: 50%;
        border: 0.125rem solid var(--fdIcon_Tab_Bar_Separator_Color);
        background: var(--sapObjectHeader_Background);

        @if $is-end {
          @include fd-set-position-right-pseudo($fd-icon-tab-bar-dnd-separator-circle-horizontal-offset);
        } @else {
          @include fd-set-position-left-pseudo($fd-icon-tab-bar-dnd-separator-circle-horizontal-offset);
        }
      }

      // aligning vertically
      &.#{$block}__list-item {
        &::before {
          right: unset;

          @include fd-set-position-left-pseudo(0.0625rem);

          width: 100%;
          height: 0.125rem;

          @if $is-end {
            top: unset;
            bottom: $fd-icon-tab-bar-dnd-separator-bar-vertical-offset;
          } @else {
            top: $fd-icon-tab-bar-dnd-separator-bar-vertical-offset;
          }
        }

        &::after {
          right: unset;

          @include fd-set-position-left-pseudo(0);

          z-index: 1;

          @if $is-end {
            top: unset;
            bottom: $fd-icon-tab-bar-dnd-separator-circle-vertical-offset;
          } @else {
            top: $fd-icon-tab-bar-dnd-separator-circle-vertical-offset;
          }
        }
      }
    }

    &--dnd-separator {
      @include icon-tab-dnd-separator($is-end: false);

      &-end {
        @include icon-tab-dnd-separator($is-end: true);
      }
    }
  }

  &__button-container {
    @include fd-reset();
    @include fd-flex-center();
    @include fd-set-width(1.5rem);
    @include fd-set-height(2.75rem);

    position: relative;

    &::before {
      left: 0;
      top: 0.75rem;
      content: '';
      height: 1rem;
      width: 0.0625rem;
      position: absolute;
      background: var(--fdIconTabBar_Multi_Click_Separator_Background);
      display: var(--fdIcon_Tab_Bar_Multi_Click_Button_Separator_Display);
    }

    @include fd-rtl() {
      &::before {
        right: 0;
        left: auto;
      }
    }
  }

  .#{$block}__button {
    border-radius: 0.25rem;
    font-family: var(--sapContent_IconFontFamily);
    width: $fd-icon-tab-bar-multi-click-button-size;
    height: $fd-icon-tab-bar-multi-click-button-size;
    min-width: $fd-icon-tab-bar-multi-click-button-size;

    --fdButton_Hover_Shadow: none;

    @include fd-focus() {
      &::after {
        border-radius: var(--fdIcon_Tab_Bar_Multi_Click_Button_Focus_Radius);
      }
    }
  }

  &__tab {
    @include fd-reset();

    @include fd-flex(column) {
      align-items: flex-start;
    }

    @include fd-selected() {
      --fdIconTabBar_Icon_Background: var(--sapSelectedColor);
      --fdIconTabBar_Icon_Color: var(--sapContent_ContrastIconColor);
      --fdIconTabBar_Tag_Color: var(--fdIcon_Tab_Bar_Selection_Color);
      --fdIconTabBar_Arrow_Color: var(--sapContent_Selected_ForegroundColor);

      @include fd-icon-tab-bar-selection-bar();

      @include fd-rtl() {
        &::after {
          left: auto;
          right: 0;
        }
      }

      & + .#{$block}__popover {
        .#{$block}__button {
          --fdButtonColor: var(--sapContent_Selected_ForegroundColor);
        }
      }
    }

    @include fd-hover() {
      --fdIconTabBar_Tag_Color: var(--fdIcon_Tab_Bar_Label_Hover_Color);
      --fdIconTabBar_Arrow_Color: var(--sapContent_Selected_ForegroundColor);
    }

    @include fd-focus() {
      box-shadow: none;
      outline: none;

      .#{$block}__icon {
        @include fd-tabs-focus(var(--sapContent_FocusColor), true) {
          border-radius: var(--fdIcon_Tab_Bar_Icon_Focus_Radius);

          @include fd-set-equal-positions(var(--fdIcon_Tab_Bar_Icon_Focus_Offset));
        }
      }

      .#{$block}__tag {
        @include fd-tabs-focus(var(--sapContent_FocusColor), true) {
          border-radius: var(--fdIcon_Tab_Bar_Text_Focus_Radius);
        }
      }

      .#{$block}__container--filter {
        @include fd-tabs-focus(var(--sapContent_FocusColor), true, 'before') {
          border-radius: var(--fdIcon_Tab_Bar_Text_Focus_Radius);
        }
      }
    }

    cursor: pointer;
    min-width: 2rem;
    position: relative;
    text-decoration: none;
    padding-block: 0.875rem;
    padding-inline: 0.188rem;
  }

  &__tab-container {
    @include fd-reset();
    @include fd-flex-center();
  }

  &__arrow {
    @include fd-reset();
    @include fd-flex-center();

    margin-inline: var(--fdIcon_Tab_Bar_Single_Click_Icon_Container_Padding_Left) var(--fdIcon_Tab_Bar_Single_Click_Icon_Container_Padding_Right);
    height: $fd-icon-tab-bar-single-click-arrow-size;
    width: var(--fdIcon_Tab_Bar_Single_Click_Icon_Container_Width);

    [class*='sap-icon'] {
      @include fd-flex-center();

      font-size: 1rem;
      color: var(--fdIconTabBar_Arrow_Color);
      width: $fd-icon-tab-bar-single-click-arrow-size;
      height: $fd-icon-tab-bar-single-click-arrow-size;
      line-height: $fd-icon-tab-bar-single-click-arrow-size;
    }
  }

  &__tag {
    @extend %fd-icon-tab-bar-text;

    position: relative;
    color: var(--fdIconTabBar_Tag_Color);
    font-size: var(--sapFontSize);
    font-family: var(--fdIcon_Tab_Bar_Label_Font_Family);
  }

  &__counter {
    @extend %fd-icon-tab-bar-text;

    margin-block-end: 0.125rem;
  }

  &__icon {
    @include fd-reset();
    @include fd-flex-center();
    @include fd-icon-tab-bar-set-circle-size(var(--fdIconTabBar_Icon_Size));

    @include fd-icon-selector() {
      font-size: var(--fdIconTabBar_Icon_Font_Size);
      color: var(--fdIconTabBar_Icon_Color);

      @include fd-inline-flex-center();
    }

    position: relative;
    margin-inline: $fd-icon-tab-bar-icon-spacing;
    background: var(--fdIconTabBar_Icon_Background);
    border: var(--fdIcon_Tab_Bar_Icon_Border_Weight) solid var(--fdIconTabBar_Icon_Border_Color);
  }

  &__details {
    @include fd-reset();

    @include fd-flex(column) {
      align-items: flex-start;
      justify-content: flex-end;
    }

    padding-inline: 0.125rem 0.25rem;
    padding-block: 0.375rem 0.25rem;
    max-width: 7.5rem;
    height: $fd-icon-tab-bar-icon-circle-size;
  }

  &__label {
    @include fd-reset();
    @include fd-ellipsis();

    line-height: 0.875rem;
    font-family: var(--fdIcon_Tab_Bar_Label_Font_Family);
    font-size: var(--sapFontSmallSize);
    color: var(--fdIcon_Tab_Bar_Label_Color);
  }

  &__separator {
    @include fd-reset();

    padding-inline: 0.5rem;

    @include fd-icon-selector() {
      font-size: 1rem;
      color: var(--sapContent_NonInteractiveIconColor);

      @include fd-rtl() {
        transform: rotate(180deg);
      }
    }
  }

  &__container {
    @include fd-reset();

    position: relative;

    .#{$block}__badge {
      @include fd-icon-tab-bar-set-circle-size(var(--fdIcon_Tab_Bar_Container_Badge_Size));
      @include fd-set-position-right($fd-icon-tab-bar-icon-spacing);

      top: 0;
      border: 0.125rem solid var(--sapContent_BadgeBorderColor);
    }

    .#{$block}__counter {
      @include fd-set-position-left($fd-icon-tab-bar-icon-circle-size);

      top: 0;
      position: absolute;
    }

    &--filter {
      @include fd-flex-vertical-center();

      height: $fd-icon-tab-bar-filter-container-height;

      $separator-position: -1 * (0.5rem + $fd-icon-tab-bar-border-thickness);

      &::after {
        padding-inline: 0;
        padding-block: 0;
        content: '';
        position: absolute;
        right: $separator-position;
        width: $fd-icon-tab-bar-border-thickness;
        background: var(--sapGroup_TitleBorderColor);
        height: $fd-icon-tab-bar-filter-container-height;
      }

      @include fd-rtl() {
        &::after {
          right: auto;
          left: $separator-position;
        }
      }
    }
  }

  &__filter-label,
  &__filter-counter {
    @include fd-reset();

    font-size: var(--sapFontSmallSize);
    color: var(--sapContent_LabelColor);
  }

  &__filter-counter {
    font-size: 1.5rem;
    margin-inline-end: 0.5rem;
  }

  &__overflow {
    @include fd-reset();

    padding-inline: 0.5rem;

    @include fd-flex-vertical-center() {
      gap: 0.375rem;
    }

    [class*='sap-icon'] {
      font-size: 1rem;
      font-family: var(--sapContent_IconFontFamily);
      color: var(--fdIconTabBar_Overflow_Button_Icon_Color);
    }

    height: 1.5rem;
    cursor: pointer;
    position: relative;
    border-radius: $fd-icon-tab-bar-overflow-button-border-radius;
    background: var(--fdIconTabBar_Overflow_Button_Background);
    border: $fd-icon-tab-bar-border-thickness solid var(--fdIconTabBar_Overflow_Button_Border_Color);

    &-text {
      @include fd-reset();

      line-height: 1.5rem;
      color: var(--fdIconTabBar_Overflow_Button_Text_Color);
      font-family: var(--fdIcon_Tab_Bar_Overflow_Button_Font_Family);
    }

    @include fd-hover() {
      --fdIconTabBar_Overflow_Button_Background: var(--sapButton_Hover_Background);
      --fdIconTabBar_Overflow_Button_Border_Color: var(--sapButton_Hover_BorderColor);
      --fdIconTabBar_Overflow_Button_Text_Color: var(--fdIcon_Tab_Bar_Overflow_Button_Text_Color_Hover);
      --fdIconTabBar_Overflow_Button_Icon_Color: var(--fdIcon_Tab_Bar_Overflow_Button_Icon_Color_Hover);
    }

    @include fd-active() {
      --fdIconTabBar_Overflow_Button_Background: var(--sapButton_Active_Background);
      --fdIconTabBar_Overflow_Button_Border_Color: var(--sapButton_Active_BorderColor);
      --fdIconTabBar_Overflow_Button_Text_Color: var(--sapButton_Active_TextColor);
      --fdIconTabBar_Overflow_Button_Icon_Color: var(--sapButton_Active_TextColor);
    }

    @include fd-focus() {
      outline: none;

      &::after {
        content: '';
        display: block;
        position: absolute;
        inset: $fd-icon-tab-bar-overflow-button-focus-offset $fd-icon-tab-bar-overflow-button-focus-offset $fd-icon-tab-bar-overflow-button-focus-offset $fd-icon-tab-bar-overflow-button-focus-offset;
        border-radius: $fd-icon-tab-bar-overflow-button-border-radius;
        border: var(--sapContent_FocusWidth) var(--sapContent_FocusStyle) var(--sapContent_FocusColor);
      }

      @include fd-active() {
        &::after {
          border:
            var(--sapContent_FocusWidth) var(--sapContent_FocusStyle)
            var(--sapContent_ContrastFocusColor);
        }
      }
    }
  }

  .#{$block}__popover {
    @include fd-set-position-right(0.188rem);

    top: 0;
    position: absolute;

    &-body {
      margin-inline-end: -0.25rem;
      margin-block-start: -0.25rem;
      z-index: 10;
    }

    .#{$block}__button {
      --fdButtonColor: var(--sapTextColor);
    }
  }

  &__badge {
    @include fd-reset();
    @include fd-flex-center();
    @include fd-icon-tab-bar-set-circle-size(0.375rem);
    @include fd-set-position-right(-1 * ($fd-icon-tab-bar-border-thickness + $fd-icon-tab-bar-icon-spacing));

    z-index: 5;
    top: 0.75rem;
    position: absolute;
    box-sizing: content-box;
    background: var(--fdIconTabBar_Badge_Background);
    border: $fd-icon-tab-bar-border-thickness solid var(--sapObjectHeader_Background);

    &--animated {
      transform: scale(0);
      animation-name: pulse-appear, pulse-disappear;
      animation-duration: 1500ms, 750ms;
      animation-delay: 0ms, 1500ms;
      animation-timing-function: ease-in, ease-out;
      animation-iteration-count: 1, 1;

      &::after {
        @include fd-icon-tab-bar-set-circle-size(0.75rem);

        opacity: 0;
        content: '';
        position: absolute;
        transform: scale(0);
        animation: pulse-after 1000ms ease-in;
        animation-delay: 1000ms;
        animation-iteration-count: 1;
        background: var(--fdIconTabBar_Badge_Background_After);
      }

      @keyframes pulse-appear {
        0% {
          transform: scale(0.25);
        }

        64% {
          transform: scale(1.25);
        }

        71% {
          transform: scale(1);
        }

        100% {
          transform: scale(1);
        }
      }

      @keyframes pulse-disappear {
        from {
          transform: scale(1);
        }

        to {
          transform: scale(0);
        }
      }

      @keyframes pulse-after {
        0% {
          transform: scale(0);
          opacity: 0;
        }

        71% {
          transform: scale(1);
          opacity: 0.2;
        }

        80% {
          transform: scale(1.17);
          opacity: 0.2;
        }

        86% {
          transform: scale(1.33);
          opacity: 0.1;
        }

        93% {
          transform: scale(1.5);
          opacity: 0;
        }

        100% {
          transform: scale(0);
          opacity: 0;
        }
      }
    }
  }

  &__icon-separator {
    @include fd-reset();

    @include fd-flex-vertical-bottom() {
      justify-content: center;
    }

    height: $fd-icon-tab-bar-icon-separator-size;
    padding-block: 0;
    padding-inline: 0.5rem;

    [class*='sap-icon'] {
      width: $fd-icon-tab-bar-icon-separator-size;
      height: $fd-icon-tab-bar-icon-separator-size;
      font-size: $fd-icon-tab-bar-icon-separator-size;
      color: var(--sapContent_NonInteractiveIconColor);
      line-height: $fd-icon-tab-bar-icon-separator-size;
    }

    @include fd-rtl() {
      [class*='sap-icon'] {
        transform: rotate(180deg);
      }
    }
  }

  &__line-separator {
    @include fd-reset();

    margin-block-start: 0.25rem;
    border-bottom: 0.0625rem solid var(--sapGroup_TitleBorderColor);

    &:first-child {
      margin-block-start: 0.5rem;
      margin-inline: $fd-icon-tab-bar-list-padding-right $fd-icon-tab-bar-list-padding-right;
    }
  }

  &__list {
    width: 100%;

    .#{$block}__list-item {
      @for $i from 1 through 10 {
        $offset: (($i - 1) * 0.5rem) + $fd-icon-tab-bar-list-padding-right;
        $offsetSeparator: ($i * 0.5rem) + $fd-icon-tab-bar-list-padding-right;

        &[aria-level='#{$i}'] {
          --fdList_Navigation_Link_Padding_Left: #{$offset};
          --fdList_Navigation_Link_Padding_Right: #{$fd-icon-tab-bar-list-padding-right};

          & + .#{$block}__line-separator {
            margin-inline: $offsetSeparator $fd-icon-tab-bar-list-padding-right;
          }
        }
      }

      span {
        flex: 0 1 auto;
      }

      .#{$block}__badge {
        position: static;
        margin-block-end: 0.625rem;

        [class*='sap-icon'] {
          margin-block-end: 0;
        }
      }

      @each $set-name, $set-params in $fd-icon-tab-bar-semantic-values {
        &--#{$set-name} {
          @include fd-icon-tab-bar-list-item-color(map.get($set-params, 'color'));
        }
      }
    }

    .#{$block}__list-item--closable {
      .#{$block}__list-link {
        --fdList_Navigation_Link_Padding_Right: 2rem;

        position: relative;
      }

      .#{$block}__button-container {
        @include fd-icon-tab-bar-close-btn-container-overwrite();
      }
    }

    .#{$block}__list-item-icon-container {
      @include fd-flex-center();

      width: 1.25rem;
      margin-inline-end: 0.25rem;
    }

    .#{$block}__list-link {
      @include fd-selected() {
        border-bottom: none;
      }

      @include fd-active() {
        @include fd-icon-tab-bar-list-item-color(var(--sapList_Active_TextColor));
      }

      @include fd-focus() {
        &::before {
          border-radius: 0.375rem;
        }
      }

      span {
        font-size: var(--sapFontSize);
      }
    }

    .#{$block}__list-item-icon [class*='sap-icon'],
    .#{$block}__list-item-icon [class*='sap-icon']:last-child {
      margin-inline: 0;
      margin-block: 0;
      width: auto;
      font-size: 1rem;
    }

    .#{$block}__line-separator:first-child {
      padding-inline: $fd-icon-tab-bar-list-padding-right;

      &::after {
        margin-block-start: 0.75rem;
      }
    }

    .#{$block}__icon-separator:first-child {
      padding-inline: $fd-icon-tab-bar-list-padding-right;
      height: 1.5rem;
    }

    @include fd-rtl() {
      .#{$block}__list-item-icon {
        justify-content: center;
      }
    }
  }

  // MODIFIERS
  &--transparent {
    .#{$block}__header {
      background: transparent;
    }

    .#{$block}__panel {
      background: transparent;
    }
  }

  &--translucent {
    .#{$block}__header {
      background: var(--sapObjectHeader_Background);
    }

    .#{$block}__panel {
      background: var(--sapGroup_ContentBackground);
    }
  }

  @include fd-compact-or-condensed() {
    --fdIconTabBar_Icon_Size: #{$fd-icon-tab-bar-icon-circle-size-compact};
    --fdIconTabBar_Icon_Font_Size: 1rem;
    --fdIcon_Tab_Bar_Container_Badge_Size: 0.375rem;
    .#{$block}__container {
      .#{$block}__counter {
        @include fd-set-position-left($fd-icon-tab-bar-icon-circle-size-compact);
      }
    }
  }

  &--counters {
    .#{$block}__tab {
      height: 3.875rem;
      justify-content: flex-end;
    }

    .#{$block}__badge {
      top: 2rem - $fd-icon-tab-bar-border-thickness;
    }
  }

  &--icon-only {
    .#{$block}__tab {
      padding-inline: 0;
      padding-block: 1rem;
      position: relative;
      flex-direction: row;
      margin-inline: 0.75rem;
    }

    .#{$block}__item {
      margin-inline: 0.25rem;

      &:first-child {
        margin-block: 0;
        margin-inline: 0 0.25rem;

        .#{$block}__tab {
          margin-inline: 0 0.75rem;
        }
      }
    }

    .#{$block}__item--closable {
      .#{$block}__tab {
        padding-inline-end: 2rem;
      }

      .#{$block}__button-container {
        @include fd-set-position-right(0.75rem);
      }
    }

    .#{$block}__container {
      .#{$block}__badge {
        $badgePosition: $fd-icon-tab-bar-icon-spacing + $fd-icon-tab-bar-border-thickness;

        @include fd-set-position-right($badgePosition);
      }

      .#{$block}__counter {
        @include fd-set-position-left($fd-icon-tab-bar-icon-circle-size + $fd-icon-tab-bar-icon-spacing);
      }
    }

    @include fd-compact-or-condensed() {
      .#{$block}__container {
        .#{$block}__counter {
          @include fd-set-position-left(
            $fd-icon-tab-bar-icon-circle-size-compact + $fd-icon-tab-bar-icon-spacing
          );
        }

        .#{$block}__badge {
          @include fd-set-position-right(0.188rem);
        }
      }
    }
  }

  &--icon {
    .#{$block}__item {
      @include fd-reset-margins();

      @each $set-name, $set-params in $fd-icon-tab-bar-semantic-values {
        &--#{$set-name} {
          .#{$block}__icon::before {
            @include fd-icon-tab-bar-reset-icon();
          }

          @include fd-rtl() {
            .#{$block}__icon::after {
              @include fd-icon-tab-bar-reset-icon();
            }
          }

          .#{$block}__label {
            &::before {
              @extend %semantic-icon-base;

              margin-inline-end: 0.5rem;
              content: map.get($set-params, 'icon');
              color: map.get($set-params, 'iconColor');
            }

            @include fd-rtl() {
              &::before {
                @include fd-icon-tab-bar-reset-icon();
              }

              &::after {
                @extend %semantic-icon-base;

                margin-inline-end: 0.5rem;
                content: map.get($set-params, 'icon');
                color: map.get($set-params, 'iconColor');
              }
            }
          }
        }
      }
    }

    .#{$block}__item--closable {
      .#{$block}__tab {
        padding-inline-end: 2rem;
      }

      .#{$block}__button-container {
        @include fd-set-position-right(0);
      }
    }

    .#{$block}__tab {
      @include fd-icon-tab-bar-process-selection-bar-width($fd-icon-tab-bar-icon-circle-size);

      padding-inline: 0;
      padding-block: 1rem;
      flex-direction: row;
    }

    .#{$block}__counter {
      margin-block-end: 0;
      line-height: 0.875rem;
      font-size: var(--sapFontSmallSize);

      & + .#{$block}__label {
        margin-block-start: 0.375rem;
      }
    }

    @include fd-compact-or-condensed() {
      .#{$block}__details {
        padding-block: 0;
        height: $fd-icon-tab-bar-icon-circle-size-compact;
      }

      .#{$block}__tab {
        @include fd-icon-tab-bar-process-selection-bar-width($fd-icon-tab-bar-icon-circle-size-compact);
      }

      .#{$block}__counter {
        & + .#{$block}__label {
          margin-block-start: 0.25rem;
        }
      }
    }
  }

  &--process {
    .#{$block}__item {
      margin-inline: 0;
    }
  }

  &--filter {
    .#{$block}__item {
      margin-inline: 0.25rem;

      &:first-child {
        margin-inline: 0 1.063rem;

        .#{$block}__tab {
          padding-block: $fd-icon-tab-bar-filter-container-top-offset 1.875rem;
          position: relative;
        }
      }

      &:nth-child(2) {
        margin-block: 0;
        margin-inline: 0 0.25rem;
      }
    }

    .#{$block}__tab {
      margin-inline: 0;
      padding-inline: 0.188rem;
      padding-block: 0.875rem 0.625rem;
      position: relative;
      align-items: center;
    }

    .#{$block}__icon {
      margin-inline: 0;
    }

    .#{$block}__label {
      width: 5rem;
      text-align: center;
      margin-block-start: 0.375rem;
    }

    @include fd-compact-or-condensed() {
      .#{$block}__item:first-child {
        .#{$block}__tab {
          padding-block: $fd-icon-tab-bar-filter-container-top-offset-compact;
        }
      }

      .#{$block}__badge {
        @include fd-set-position-right(0.063rem);
      }
    }
  }

  &.#{$block}--navigation {
    .#{$block}__header {
      box-shadow: var(--sapShell_Shadow);
      background: var(--sapShell_Navigation_Background);
    }

    .#{$block}__item {
      color: var(--sapShell_Navigation_TextColor);
    }

    .#{$block}__tab {
      @include fd-set-navigation-tab-colors(var(--sapShell_Navigation_TextColor)) {
        font-size: 1rem;
        height: 1rem;
        line-height: 1;
        margin-inline-end: 0.5rem;
      }

      @include fd-selected() {
        @include fd-set-navigation-tab-colors();

        &::after {
          background: var(--sapShell_Navigation_SelectedColor);
        }

        & + .fd-icon-tab-bar__popover {
          .#{$block}__button {
            --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color_Active);
          }
        }
      }

      @include fd-hover() {
        @include fd-set-navigation-tab-colors();
      }

      @include fd-focus() {
        .#{$block}__tag {
          @include fd-tabs-focus(var(--sapShell_Navigation_TextColor), true);
        }

        .#{$block}__tab-container {
          @include fd-tabs-remove-focus-from-tag();
          @include fd-tabs-focus(var(--sapShell_Navigation_TextColor), true);

          position: relative;
        }
      }

      .#{$block}__arrow {
        [class*='sap-icon'] {
          margin-inline: 0;
          margin-block: 0;
        }
      }
    }

    .#{$block}__overflow {
      --fdIconTabBar_Overflow_Button_Background: var(--fdIconTabBar_Overflow_Button_Shell_Background);
      --fdIconTabBar_Overflow_Button_Border_Color: var(--fdIconTabBar_Overflow_Button_Shell_Border_Color);
      --fdIconTabBar_Overflow_Button_Text_Color: var(--fdIconTabBar_Overflow_Button_Shell_Text_Color);
      --fdIconTabBar_Overflow_Button_Icon_Color: var(--fdIconTabBar_Overflow_Button_Shell_Icon_Color);

      @include fd-hover() {
        --fdIconTabBar_Overflow_Button_Background: var(--fdIconTabBar_Overflow_Button_Shell_Background_Hover);
        --fdIconTabBar_Overflow_Button_Border_Color:
          var(
            --fdIconTabBar_Overflow_Button_Shell_Border_Color_Hover
          );
        --fdIconTabBar_Overflow_Button_Text_Color: var(--fdIconTabBar_Overflow_Button_Shell_Text_Color_Hover);
        --fdIconTabBar_Overflow_Button_Icon_Color: var(--fdIconTabBar_Overflow_Button_Shell_Icon_Color_Hover);
      }

      @include fd-active() {
        --fdIconTabBar_Overflow_Button_Background: var(--fdIconTabBar_Overflow_Button_Shell_Background_Active);
        --fdIconTabBar_Overflow_Button_Border_Color:
          var(
            --fdIconTabBar_Overflow_Button_Shell_Border_Color_Active
          );
        --fdIconTabBar_Overflow_Button_Text_Color: var(--fdIconTabBar_Overflow_Button_Shell_Text_Color_Active);
        --fdIconTabBar_Overflow_Button_Icon_Color: var(--fdIconTabBar_Overflow_Button_Shell_Icon_Color_Active);
      }

      @include fd-focus() {
        &::after {
          border-color: var(--fdIconTabBar_Overflow_Button_Shell_Focus_Color);
        }
      }
    }

    .#{$block}__button {
      --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color);

      @include fd-hover() {
        --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color_Hover);
        --fdButtonBorderColor: var(--fdIconTabBar_Button_Shell_Background_Color_Hover);
        --fdButtonBackgroundColor: var(--fdIconTabBar_Button_Shell_Background_Color_Hover);
      }

      @include fd-active() {
        --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color_Active);
        --fdButtonBackgroundColor: var(--fdIconTabBar_Button_Shell_Background_Color_Active);
        --fdButtonBorderColor: var(--fdIconTabBar_Button_Shell_Background_Color_Active);
      }

      @include fd-focus() {
        --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color_Active);
        --fdButtonBackgroundColor: var(--sapShell_Navigation_Background);
        --fdButtonBorderColor: var(--sapShell_Navigation_Background);

        &::after {
          border-color: var(--fdIconTabBar_Button_Shell_Focus_Color);
        }
      }

      @include fd-selected() {
        --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color_Active);
        --fdButtonBackgroundColor: var(--fdIconTabBar_Button_Shell_Background_Color_Selected);
        --fdButtonBorderColor: var(--fdIconTabBar_Button_Shell_Background_Color_Selected);

        @include fd-hover() {
          --fdButtonColor: var(--fdIconTabBar_Button_Shell_Color_Hover);
          --fdButtonBorderColor: transparent;
          --fdButtonBackgroundColor: var(--fdIconTabBar_Button_Shell_Background_Color_Hover);
        }
      }
    }
  }

  &.#{$block}--navigation-flat {
    .#{$block}__header {
      background: var(--sapShellColor);
    }

    .#{$block}__item {
      &--with-separator {
        position: relative;
        margin-inline-end: 2rem;

        &::after {
          content: '';
          position: absolute;
          width: 0.063rem;
          height: 1.5rem;
          background: var(--sapShell_InteractiveBorderColor);
          right: -1rem;
        }

        @include fd-rtl() {
          &::after {
            right: auto;
            left: -1rem;
          }
        }
      }
    }
  }

  &--navigation-horizontal {
    .#{$block}__header {
      box-shadow: none;
    }

    .#{$block}__tab {
      padding-block: 0.75rem 1rem;

      @include fd-selected() {
        &::after {
          border-radius: 0.125rem;
          margin-block-end: 0.188rem;
        }
      }
    }

    .#{$block}__button-container {
      align-items: normal;

      .#{$block}__button {
        margin-block-start: 0.5rem;
      }
    }
  }

  @each $set-name, $set-padding in $fd-icon-tab-bar-responsive-paddings {
    &--#{$set-name} {
      .#{$block}__header {
        padding-block: 0;
        padding-inline: map.get($set-padding, 'padding');
      }
    }
  }

  &--responsive-paddings {
    .#{$block}__header {
      padding-block: 0;

      @include fd-apply-responsive-paddings();
    }
  }
}

.#{$block},
.#{$block}--filter,
.#{$block}--icon,
.#{$block}--icon-only,
.#{$block}--navigation,
.#{$block}--navigation-flat,
.#{$block}--process {
  .#{$block}__item {
    &--overflow {
      margin-inline: 0;
      margin-block: 0;

      &:last-of-type {
        margin-inline-start: auto;
      }

      .#{$block}__popover {
        position: relative;

        &-body {
          margin-inline-end: -0.25rem;
          margin-block-start: 0.375rem;
        }
      }
    }
  }
}
