@import "./new-settings";
@import "./mixins";
@import "./mixins/button/button-helper";
@import "./mixins/input/addon-button";

/*!
.fd-input-group+(--inline, --control)
    .fd-input-group__addon+(--button)
*/

$block: #{$fd-namespace}-input-group;

$fd-input-border-radius: var(--sapField_BorderCornerRadius);

.#{$block} {
  @mixin fd-addon-button-border() {
    border-left-color: var(--fdButton_Addon_Sideborder_Color);

    @include fd-rtl() {
      border-left-color: transparent;
      border-right-color: var(--fdButton_Addon_Sideborder_Color);
    }
  }

  @mixin fd-addon-active-button-border() {
    border-left-color: var(--fdButton_Addon_Interractive_SideBorder_Color);

    @include fd-rtl() {
      border-left-color: transparent;
      border-right-color: var(--fdButton_Addon_Interractive_SideBorder_Color);
    }
  }

  $fd-input-padding: 0.625rem;
  $fd-input-width-basis: 10rem;
  $fd-input-group-add-on-border: 0.0625rem;

  @include fd-reset();

  display: flex;
  border-style: solid;
  border-width: var(--sapField_BorderWidth);
  border-color: var(--sapField_BorderColor);
  border-radius: var(--sapField_BorderCornerRadius);
  background-color: var(--sapField_Background);
  width: 100%;
  overflow: hidden;
  position: relative;

  // states
  @include fd-form-base();
  @include fd-form-states();
  @include fd-addon-button();

  @include fd-form-input-pseudo-focus(
    var(--fdStepInput_Focus_Border_Offset),
    var(--fdInputGroup_Focus_Border_Radius)
  ) {
    z-index: 10;
  }

  > * {
    border-radius: $fd-input-border-radius;

    &:first-child {
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
    }

    &:last-child {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }

    &:not(:first-child):not(:last-child) {
      border-radius: 0;
    }

    @include fd-rtl() {
      border-radius: $fd-input-border-radius;

      &:first-child {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
      }

      &:last-child {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }
    }
  }

  .#{$block}__input {
    @include fd-reset-child-spacing();

    border: none;
    flex: 1 1 $fd-input-width-basis;
    padding-right: 0.25rem;
    padding-left: 0.25rem;
    background: none !important;

    @include fd-hover() {
      box-shadow: none;
    }

    @include fd-focus() {
      outline: none;
      box-shadow: none;
    }

    &:nth-child(1) {
      @include fd-set-padding-left($fd-input-padding);
    }

    &:nth-last-child(1) {
      @include fd-set-padding-right($fd-input-padding);
    }
  }

  &--inline {
    display: inline-flex;
    vertical-align: bottom;
    width: auto;
  }

  &__addon {
    @include fd-reset();
    @include fd-flex-center();

    color: var(--sapContent_NonInteractiveIconColor);
    background: none !important;
    font-size: var(--sapFontLargeSize);
    min-width: 2.25rem;
    min-height: $fd-form-input-height;
    padding-left: 0.625rem;
    padding-right: 0.625rem;

    span[class*='sap-icon--'] {
      &::before {
        font-size: var(--sapFontLargeSize);
      }
    }

    &--compact {
      min-width: 2rem;
      min-height: $fd-form-input-height--compact;
    }

    &--readonly {
      opacity: 0.4;
    }

    &--button {
      padding: 0;
      display: flex;
      flex-direction: column;
      border: none;
      border-radius: $fd-input-group-add-on-border;

      .#{$block}__button {
        @include fd-reset-child-spacing();

        border-radius: 0;
        height: 100%;
        max-height: 100%;
      }

      > * {
        border-radius: 0;
      }

      &:not(:first-child):not(:last-child) {
        .#{$block}__button {
          border-radius: 0;
        }
      }

      &:first-child {
        .#{$block}__button {
          border-radius: var(--fdButton_Addon_FirstChild_Border_Radius);
        }
      }

      &:last-child {
        .#{$block}__button {
          border-radius: var(--fdButton_Addon_LastChild_Border_Radius);
        }
      }

      @include fd-rtl() {
        // reverse the border radius sides in rtl mode
        &:first-child {
          border-radius: var(--fdButton_Addon_LastChild_Border_Radius);
          margin-right: 0;
        }

        &:last-child {
          border-radius: var(--fdButton_Addon_FirstChild_Border_Radius);
          margin-left: 0;
        }
      }
    }
  }

  &__button {
    @include fd-ellipsis();

    width: 100%;
    z-index: auto !important;
    position: static !important;
    border-color: transparent;
    border-width: var(--sapField_BorderWidth);

    @include fd-addon-button-border();

    @include fd-hover() {
      border-color: transparent;

      @include fd-addon-active-button-border();
    }

    @include fd-active() {
      border-color: transparent;

      @include fd-addon-active-button-border();
    }

    @include fd-focus() {
      @include fd-button-focus() {
        outline-color: var(--sapField_Hover_BorderColor);
      }
    }

    @include fd-disabled() {
      background: none !important;
      box-shadow: none !important;
    }

    &::before {
      display: none !important;
    }
  }

  .#{$fd-namespace}-textarea {
    resize: vertical;
  }

  .#{$fd-namespace}-tokenizer {
    background: none;
    border: none;
  }

  &[readonly],
  &.is-readonly {
    overflow: visible;

    .#{$block}__addon {
      display: none;
    }
  }
}
