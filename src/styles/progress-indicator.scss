@import "./new-settings";
@import "./mixins";

$block: #{$fd-namespace}-progress-indicator;
$fd-progress-indicator-margin: 0.5rem 0 !default;
$fd-progress-indicator-margin-mobile: 0.875rem 0 !default;
$fd-progress-indicator-container-height: 1rem !default;

$fd-progress-indicator-states: (
  "informative": (
    "background": var(--fdProgress_Indicator_Background_Color_Informative),
    "borderColor": var(--fdProgress_Indicator_Progress_Bar_Border_Color_Informative, transparent),
    "containerBackground": var(--fdProgress_Indicator_Container_Background_Informative, var(--sapField_Background)),
    "containerBorderColor": var(--fdProgress_Indicator_Container_Border_Color_Informative, var(--sapField_BorderColor)),
    "icon": var(--fdProgress_Icon_Informative),
    "iconColor": var(--fdProgress_Icon_Color_Informative, var(--sapField_TextColor)),
  ),
  "positive": (
    "background": var(--fdProgress_Indicator_Background_Color_Positive),
    "borderColor": var(--fdProgress_Indicator_Progress_Bar_Border_Color_Positive, transparent),
    "containerBackground": var(--fdProgress_Indicator_Container_Background_Positive, var(--sapField_Background)),
    "containerBorderColor": var(--fdProgress_Indicator_Container_Border_Color_Positive, var(--sapField_BorderColor)),
    "icon": var(--fdProgress_Icon_Positive),
    "iconColor": var(--fdProgress_Icon_Color_Positive, var(--sapField_TextColor)),
  ),
  "negative": (
    "background": var(--fdProgress_Indicator_Background_Color_Negative),
    "borderColor": var(--fdProgress_Indicator_Progress_Bar_Border_Color_Negative, transparent),
    "containerBackground": var(--fdProgress_Indicator_Container_Background_Negative, var(--sapField_Background)),
    "containerBorderColor": var(--fdProgress_Indicator_Container_Border_Color_Negative, var(--sapField_BorderColor)),
    "icon": var(--fdProgress_Icon_Negative),
    "iconColor": var(--fdProgress_Icon_Color_Negative, var(--sapField_TextColor)),
  ),
  "critical": (
    "background": var(--fdProgress_Indicator_Background_Color_Critical),
    "borderColor": var(--fdProgress_Indicator_Progress_Bar_Border_Color_Critical, transparent),
    "containerBackground": var(--fdProgress_Indicator_Container_Background_Critical, var(--sapField_Background)),
    "containerBorderColor": var(--fdProgress_Indicator_Container_Border_Color_Critical, var(--sapField_BorderColor)),
    "icon": var(--fdProgress_Icon_Critical),
    "iconColor": var(--fdProgress_Icon_Color_Critical, var(--sapField_TextColor)),
  )
);

.#{$block},
.#{$block}.#{$fd-namespace}-popover {
  --progressBarBackground: var(--fdProgress_Indicator_Background_Color_Neutral);
  --progressBarBorderColor: var(--fdProgress_Indicator_Progress_Bar_Border_Color_Neutral, transparent);
  --containerBackground: var(--fdProgress_Indicator_Container_Background_Neutral, var(--sapField_Background));
  --containerBorderColor: var(--fdProgress_Indicator_Container_Border_Color_Neutral, var(--sapField_BorderColor));
  --iconDisplay: none;
  --iconContent: '';

  @include fd-reset();

  width: 100%;
  height: var(--fdProgress_Indicator_Height);
  margin: $fd-progress-indicator-margin;
  padding: var(--fdProgress_Indicator_Container_Margin);

  &.#{$fd-namespace}-popover {
    margin: $fd-progress-indicator-margin;
  }

  @each $set-name, $set-state in $fd-progress-indicator-states {
    &--#{$set-name} {
      --progressBarBackground: #{map_get($set-state, "background")};
      --progressBarBorderColor: #{map_get($set-state, "borderColor")};
      --containerBackground: #{map_get($set-state, "containerBackground")};
      --containerBorderColor: #{map_get($set-state, "containerBorderColor")};
      --iconContent: #{map_get($set-state, "icon")};
      --iconDisplay: inline-block;
      --iconColor: #{map_get($set-state, "iconColor")};
    }
  }

  .#{$block}__container {
    @include fd-reset();
    @include fd-flex();

    position: relative;
    min-width: 4rem;
    width: var(--fdProgress_Indicator_Container_Width);
    border-radius: 0.5rem;
    background: var(--containerBackground);
    overflow: var(--fdProgress_Indicator_Container_Overflow);
    height: var(--fdProgress_Indicator_Container_Height);
    min-height: var(--fdProgress_Indicator_Container_Height);
    border: 0.0625rem solid var(--containerBorderColor);

    &::before,
    &::after {
      position: absolute;
      content: '';
      display: var(--fdProgress_Indicator_Progress_Bar_Boundary_Display, none);
      background-color: var(--progressBarBackground);
      width: 0.25rem;
      height: 0.25rem;
      border-radius: 50%;
      top: 0.0005rem;
    }

    &::before {
      left: 0.0005rem;
    }

    &::after {
      right: 0.0005rem;
    }
  }

  &__progress-bar {
    @include fd-reset();
    @include fd-ellipsis();

    @include fd-flex() {
      justify-content: flex-end;
    }

    height: var(--fdProgress_Indicator_Progress_Bar_Height);
    margin: var(--fdProgress_Indicator_Progress_Bar_Margin);
    border: var(--fdProgress_Indicator_Progress_Bar_Border) var(--progressBarBorderColor);
    border-right: var(--fdProgress_Indicator_Border_Right);
    border-radius: var(--fdProgress_Indicator_Progress_Bar_Border_Radius);
    background: var(--progressBarBackground);
    position: var(--fdProgress_Indicator_Progress_Bar_Position, static);
    left: -0.0625rem;
    bottom: -0.1875rem;

    &.#{$fd-namespace}-popover__control {
      position: absolute;
      .#{$block}__label {
        top: -1.25rem;
      }
    }

    .#{$block}__label {
      color: var(--fdProgress_Indicator_Label_Color_Contrast);
    }

    @include fd-rtl() {
      border-right: none;
      border-left: var(--fdProgress_Indicator_Border_Right);
    }
  }

  &__remaining {
    @include fd-reset();
    @include fd-flex();
    @include fd-ellipsis();
  }

  &__icon {
    position: var(--fdProgress_Indicator_Icon_Position, static);
    right: -1.25rem;
    bottom: -0.625rem;
    display: var(--iconDisplay);

    &::before {
      vertical-align: middle;
      font-family: "SAP-icons";
      color: var(--iconColor);
      font-size: var(--fdProgress_Indicator_Icon_Font_Size);
      content: var(--iconContent);
      margin-left: var(--fdProgress_Icon_Offset_Left);
      margin-right: var(--fdProgress_Icon_Offset_Right);
    }
  }

  &__label {
    @include fd-reset();
    @include fd-ellipsis();

    margin: var(--fdProgress_Indicator_Label_Margin);
    position: var(--fdProgress_Indicator_Label_Position, static);
    top: -1.25rem;
    left: 0;
    user-select: none;
    line-height: normal;
    color: var(--fdProgress_Indicator_Label_Color);
    font-size: var(--sapFontSmallSize);
  }

  &__overflow {
    @include fd-reset();

    @include fd-flex-vertical-center() {
      justify-content: space-between;
    }

    @include fd-set-padding-left(0.5rem);

    overflow: hidden;
    white-space: normal;
    max-width: 95vw;
  }

  &__overflow-close {
    @include fd-reset();
    @include fd-set-margin-left(0.5rem);

    @include fd-focus() {
      outline: var(--sapContent_FocusWidth) var(--sapContent_FocusStyle) var(--sapContent_FocusColor);
    }

    cursor: pointer;
    width: 1.4375rem;
    height: 1.375rem;
    margin: 0.125rem;
    text-align: center;
    line-height: 1.6rem;
    background: transparent;

    [class*='sap-icon'] {
      font-size: var(--sapFontSmallSize);
      color: var(--sapContent_IconColor);
    }
  }

  &--mobile {
    margin: $fd-progress-indicator-margin-mobile;

    &.#{$fd-namespace}-popover {
      margin: $fd-progress-indicator-margin-mobile;
    }
  }

  &--display {
    margin: 0;

    &.#{$fd-namespace}-popover {
      margin: 0;
    }
  }
}
