@import "./mixins";
@import "./mixins/list/list-definitions";
@import "./mixins/tree/mixins";

// VARIABLES
$block: #{$fd-namespace}-tree;
$button: #{$fd-namespace}-button;
$first-level-item-container: '.#{$block}__item[aria-level="1"] > .#{$block}__item-container';
$active-item-container: '.#{$block}__item-container.#{$block}__item-container--active';

$fd-tree-item-height: 2.75rem !default;
$fd-tree-item-height-compact: 2rem !default;
$fd-tree-item-padding-right: 1rem !default;
$fd-tree-item-padding-right-negative: -1rem !default;
$fd-tree-expander-size: 2.75rem !default;
$fd-tree-expander-size-compact: 2rem !default;
$fd-tree-expander-size-negative: -2.75rem !default;
$fd-tree-expander-size-negative-compact: -2rem !default;
$fd-tree-icon-size: 2.75rem !default;
$fd-tree-icon-size-compact: 2rem !default;
$fd-tree-navigated-box-shadow: inset -0.1875rem 0 0 0 var(--sapSelectedColor) !default;
$fd-tree-navigated-box-shadow-rtl: inset 0.1875rem 0 0 0 var(--sapSelectedColor) !default;
$fd-tree-highlight-box-shadow: inset 0.375rem 0 0 0 !default;
$fd-tree-highlight-box-shadow-rtl: inset -0.375rem 0 0 0 !default;
$fd-tree-item-transparent-border-bottom: var(--sapList_BorderWidth) solid transparent !default;
$fd-tree-item-selected-border-bottom: var(--sapList_BorderWidth) solid var(--sapList_SelectionBorderColor) !default;

@mixin set-highlight($color) {
  box-shadow: $fd-tree-highlight-box-shadow $color;

  @include fd-rtl() {
    box-shadow: $fd-tree-highlight-box-shadow-rtl $color;
  }

  @include fd-navigated() {
    box-shadow: $fd-tree-navigated-box-shadow, $fd-tree-highlight-box-shadow $color;

    @include fd-rtl() {
      box-shadow: $fd-tree-navigated-box-shadow-rtl, $fd-tree-highlight-box-shadow-rtl $color;
    }
  }
}

@mixin text-wrapping-behaviour() {
  white-space: normal;
  overflow: visible;
  text-overflow: initial;
}

// BLOCK
.#{$block} {
  @include fd-reset();

  width: 100%;
  list-style-type: none;

  &[aria-hidden="true"] {
    display: none;
  }

  @include fd-tree-expand-indents();

  // ELEMENTS
  &__item {
    @include fd-reset();
  }

  #{$first-level-item-container} {
    padding-left: $fd-tree-expander-size;
    background: var(--sapList_Background);
    border-bottom: var(--sapList_BorderWidth) solid var(--sapList_BorderColor);

    @include fd-rtl() {
      padding-left: $fd-tree-item-padding-right;
      padding-right: $fd-tree-expander-size;
    }

    @include fd-selected() {
      @include fd-list-item-base-selected-state();
    }
  }

  &__item-container {
    @include fd-reset();
    @include fd-flex-vertical-center();

    position: relative;

    @include fd-selected() {
      @include fd-list-item-base-selected-state();
    }

    @include fd-navigated() {
      box-shadow: $fd-tree-navigated-box-shadow;

      @include fd-rtl() {
        box-shadow: $fd-tree-navigated-box-shadow-rtl;
      }
    }

    @include fd-list-fake-outline() {
      bottom: 0.0625rem;
    }

    width: 100%;
    min-height: $fd-tree-item-height;
    padding-right: $fd-tree-item-padding-right;
    background: var(--sapList_AlternatingBackground);
    border-bottom: $fd-tree-item-transparent-border-bottom;
  }

  .#{$block}__item[aria-level="1"] > #{$active-item-container},
  #{$active-item-container} {
    @include fd-tree-item-states();
  }

  &__expander {
    @include fd-reset();

    .#{$block}__icon {
      @include fd-icon-selector() {
        font-size: var(--sapFontLargeSize);
        color: var(--sapButton_IconColor);

        @include fd-flex-center();
      }
    }

    cursor: pointer;
    color: var(--sapButton_IconColor);
    background: transparent;
    min-width: $fd-tree-expander-size;
    min-height: $fd-tree-expander-size;
    margin-left: $fd-tree-expander-size-negative;

    @include fd-rtl() {
      margin-left: 0;
      margin-right: $fd-tree-expander-size-negative;
    }

    @include fd-expanded() {
      border-bottom: none;
    }
  }

  &__content {
    @include fd-reset();
    @include fd-ellipsis();
    @include fd-flex-vertical-center();

    min-height: $fd-tree-item-height;
    width: 100%;
    text-decoration: none;

    &--wrap {
      @include text-wrapping-behaviour();

      .#{$block}__text {
        @include text-wrapping-behaviour();

        line-height: 1.4;
      }
    }
  }

  &__icon {
    @include fd-flex-center();

    min-width: $fd-tree-icon-size;
    min-height: $fd-tree-icon-size;
    line-height: $fd-tree-icon-size; // IE11 fix for vertical alignment

    @include fd-icon-selector() {
      font-size: 1.125rem;
      color: var(--sapContent_NonInteractiveIconColor);

      @include fd-flex-center();
    }

    &--navigation {
      @include fd-icon-selector() {
        min-width: 2.5rem;
        font-size: 0.75rem;
      }

      &:last-child {
        margin-right: $fd-tree-item-padding-right-negative;
      }

      @include fd-rtl() {
        &:last-child {
          margin-right: 0;
          margin-left: $fd-tree-item-padding-right-negative;
        }
      }
    }
  }

  &__text {
    @include fd-reset();
    @include fd-ellipsis();

    width: 100%;
    font-size: var(--sapFontLargeSize);
    color: var(--sapList_TextColor);
    line-height: $fd-tree-item-height; // IE11 fix for vertical alignment
  }

  // MODIFIERS
  &--compact {
    #{$first-level-item-container} {
      padding-left: $fd-tree-expander-size-compact;

      @include fd-rtl() {
        padding-left: $fd-tree-item-padding-right;
        padding-right: $fd-tree-expander-size-compact;
      }
    }

    .#{$block}__item-container {
      min-height: $fd-tree-item-height-compact;
    }

    .#{$block}__content {
      min-height: $fd-tree-item-height-compact;

      &--wrap {
        .#{$block}__text {
          line-height: 1.4;
        }
      }
    }

    .#{$block}__text {
      font-size: var(--sapFontSize);
      line-height: $fd-tree-item-height-compact; // IE11 fix for vertical alignment
    }

    .#{$block}__expander {
      min-height: $fd-tree-expander-size-compact;
      min-width: $fd-tree-expander-size-compact;
      margin-left: $fd-tree-expander-size-negative-compact;

      @include fd-icon-selector() {
        font-size: var(--sapFontSmallSize);
      }

      @include fd-rtl() {
        margin-left: 0;
        margin-right: $fd-tree-expander-size-negative-compact;
      }
    }

    .#{$block}__icon {
      min-height: $fd-tree-icon-size-compact;
      line-height: $fd-tree-icon-size-compact;
      font-size: 1rem;
    }
  }

  &--no-border {
    #{$first-level-item-container} {
      border-bottom: $fd-tree-item-transparent-border-bottom;

      @include fd-selected() {
        border-bottom: $fd-tree-item-selected-border-bottom;
      }
    }
  }

  &--active {
    .#{$block}__item-container,
    #{$first-level-item-container} {
      @include fd-tree-item-states();
    }
  }

  &--no-data {
    .#{$block}__text {
      text-align: center;
    }
  }

  .has-highlight-indicator {
    @include set-highlight(var(--sapInformationBorderColor));

    &--error {
      @include set-highlight(var(--sapErrorBorderColor));
    }

    &--warning {
      @include set-highlight(var(--sapWarningBorderColor));
    }

    &--success {
      @include set-highlight(var(--sapSuccessBorderColor));
    }
  }
}
