@import "./settings";
@import "./mixins";
@import "./functions";

/*!
.fd-calendar+(--compact, --mobile)
    .fd-calendar__header
      .fd-calendar__navigation
        .fd-calendar__action(+[--arrow-left, --arrow-right])
    .fd-calendar__content(+[--months, --years])
        .fd-calendar__table
          .fd-calendar__group
            .fd-calendar__row
              .fd-calendar__item(+[--other-month, --current, --side-helper, --weekend, --active, --range, --disabled])
                .fd-calendar__text
*/
$block: #{$fd-namespace}-calendar;

// Calendar default
$fd-calendar-padding: 1rem !default;
$fd-calendar-item-width: 2.25rem !default;
$fd-calendar-item-height: 2.75rem !default;
$fd-calendar-border-radius: 0.25rem !default;
$fd-calendar-background: var(--sapList_Background) !default;
$fd-calendar-width: $fd-calendar-item-width * 8 + 2 * $fd-calendar-padding !default;

// Compact dimensions
$fd-calendar-action-padding: 0.5rem !default;
$fd-calendar-padding-compact: 0.5rem !default;
$fd-calendar-item-width-compact: 2rem !default;
$fd-calendar-item-height-compact: 2rem !default;
$fd-calendar-width-compact: $fd-calendar-item-width-compact * 8 + 2 * $fd-calendar-padding-compact !default;

// Calendar items variations
$fd-calendar-item-color: var(--sapTextColor) !default;
$fd-calendar-item-background: #f7f7f7 !default; // Should be darken(var(--sapList_Background), 3)
$fd-calendar-item-background-hover: #d9d9d9 !default; // Should be darken(var(--sapList_Background), 15)

$fd-calendar-item-helper-height: 2rem !default;
$fd-calendar-item-helper-font: var(--sapFontSmallSize) !default;
$fd-calendar-item-helper-color: var(--sapContent_LabelColor) !default;

$fd-calendar-item-active-color: var(--sapContent_ContrastTextColor) !default;
$fd-calendar-item-active-background: var(--sapActiveColor) !default;
$fd-calendar-item-active-background-hover: #095caf !default; // Should be lighten(--sapActiveColor, 3)
$fd-calendar-item-active-inner-border-radius: 0.125rem !default; // Should be lighten(--sapList_BorderColor,10)
$fd-calendar-item-active-inner-border-width: 0.0625rem !default; // Should be lighten(--sapList_BorderColor,10)
$fd-calendar-item-active-inner-border-color: #ffffff !default; // Should be lighten(--sapList_BorderColor,10)
$fd-calendar-item-active-inner-border: $fd-calendar-item-active-inner-border-width solid $fd-calendar-item-active-inner-border-color !default;

$fd-calendar-item-inactive-color: var(--sapContent_LabelColor) !default;
$fd-calendar-item-inactive-background: var(--sapList_Background) !default;
$fd-calendar-item-inactive-background-hover: #e6e6e6 !default; // Should be darken(var(--sapList_Background), 10)

$fd-calendar-item-weekend-background: #dedede !default; // darken(--sapList_Background, 13)
$fd-calendar-item-weekend-background-hover: #cccccc !default; // darken(--sapList_Background, 20)

$fd-calendar-item-range-background: var(--sapList_SelectionBackgroundColor) !default;
$fd-calendar-item-range-background-hover: var(--sapList_Hover_SelectionBackground) !default;
$fd-calendar-item-range-border: solid 0.0625rem var(--sapList_SelectionBorderColor) !default;

$fd-calendar-item-current-border: solid medium var(--sapAccentColor4) !default;

$fd-calendar-item-disabled-color: fd-color-state("disabled", "action") !default;

// Special Days
$fd-special-day-marker-height: 0.25rem;
$fd-special-day-marker-top-border-width: $fd-special-day-marker-height + 0.0625rem;
$fd-calendar-special-days: (
  "1": var(--sapLegendColor1),
  "2": var(--sapLegendColor2),
  "3": var(--sapLegendColor3),
  "4": var(--sapLegendColor4),
  "5": var(--sapLegendColor5),
  "6": var(--sapLegendColor6),
  "7": var(--sapLegendColor7),
  "8": var(--sapLegendColor8),
  "9": var(--sapLegendColor9),
  "10": var(--sapLegendColor10),
  "11": var(--sapLegendColor11),
  "12": var(--sapLegendColor12),
  "13": var(--sapLegendColor13),
  "14": var(--sapLegendColor14),
  "15": var(--sapLegendColor15),
  "16": var(--sapLegendColor16),
  "17": var(--sapLegendColor17),
  "18": var(--sapLegendColor18),
  "19": var(--sapLegendColor19),
  "20": var(--sapLegendColor20),
);

@mixin special-days($nameColorMap) {
  @each $name, $color in $nameColorMap {
    .#{$block}__special-day--#{$name} {
      .#{$block}__text {
        box-shadow: inset 0 0 -$fd-special-day-marker-height $color;
      }

      &.#{$block}__item--active,
      &.#{$block}__item--current {
        .#{$block}__text {
          box-shadow: inset 0 0 -$fd-special-day-marker-height $color, inset 0 0 -$fd-special-day-marker-top-border-width $fd-calendar-item-active-inner-border-color;
        }
      }
    }
  }
}

%fd-calendar-item {
  position: relative;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: center;
  color: $fd-calendar-item-color;
  height: $fd-calendar-item-height;
  background-color: $fd-calendar-item-background;
  border-radius: $fd-calendar-border-radius;

  @include fd-hover() {
    @include action-cursor();

    background-color: $fd-calendar-item-background-hover;
  }

  // TODO ?
  @include fd-focus() {
    box-shadow: none;
    outline-offset: -0.1875rem;
    outline-width: var(--sapContent_FocusWidth);
    outline-color: var(--sapContent_FocusColor);
    outline-style: var(--sapContent_FocusStyle);
  }
}

%fd-calendar-item-side-helper {
  @include fd-reset();

  @extend %fd-calendar-item;

  text-align: center;
  pointer-events: none;
  color: $fd-calendar-item-helper-color;
  width: $fd-calendar-item-width-compact;
  height: $fd-calendar-item-helper-height;
  font-size: $fd-calendar-item-helper-font;
  background-color: $fd-calendar-background;
}

%fd-calendar-item-other-month {
  color: $fd-calendar-item-inactive-color;
  background-color: $fd-calendar-background;

  @include fd-hover() {
    background-color: $fd-calendar-item-inactive-background-hover;
  }
}

%fd-calendar-item-weekend {
  background-color: $fd-calendar-item-weekend-background;

  @include fd-hover() {
    background-color: $fd-calendar-item-weekend-background-hover;
  }
}

%fd-calendar-item-current {
  border: $fd-calendar-item-current-border;
}

%fd-calendar-item-active {
  color: $fd-calendar-item-active-color;
  background-color: $fd-calendar-item-active-background;

  @include fd-hover() {
    background-color: $fd-calendar-item-active-background-hover;
  }

  @include fd-focus() {
    box-shadow: none;
    outline-color: var(--sapContent_ContrastFocusColor);
  }
}

%fd-calendar-item-range {
  border: $fd-calendar-item-range-border;
  background-color: $fd-calendar-item-range-background;

  @include fd-hover() {
    background-color: $fd-calendar-item-range-background-hover;
  }
}

%fd-calendar-item-disabled {
  pointer-events: none;
  opacity: 0.4;

  &:hover {
    cursor: not-allowed;
  }
}

.#{$block} {
  @include fd-reset();

  width: $fd-calendar-width;
  padding: $fd-calendar-padding;
  background-color: $fd-calendar-background;

  &__header {
    display: flex;
    align-items: center;

    .#{$block}__navigation {
      display: flex;
      flex-grow: 1;
      align-items: center;
      justify-content: space-between;

      .#{$block}__action {
        flex-grow: 1;
        margin-left: $fd-calendar-action-padding / 2;
        margin-right: $fd-calendar-action-padding / 2;

        > * {
          width: 100%;
        }

        &--arrow-left {
          flex-grow: 0;
          margin-left: 0;
          width: $fd-calendar-item-width;
        }

        &--arrow-right {
          flex-grow: 0;
          margin-right: 0;
          width: $fd-calendar-item-width;
        }

        [class*="sap-icon"] {
          @include fd-rtl() {
            transform: scaleX(-1);
          }
        }
      }
    }
  }

  &__content {
    &--years,
    &--months {
      padding-top: $fd-calendar-item-helper-height;
    }

    .#{$block}__table {
      width: 100%;
      display: table;
      border-collapse: separate;

      .#{$block}__group {
        display: table-row-group;

        .#{$block}__row {
          display: table-row;

          .#{$block}__item {
            @include fd-reset-spacing();

            @extend %fd-calendar-item;

            display: table-cell;

            &--side-helper {
              @extend %fd-calendar-item-side-helper;
            }

            &--other-month {
              @extend %fd-calendar-item-other-month;
            }

            &--weekend {
              @extend %fd-calendar-item-weekend;
            }

            &--active {
              @extend %fd-calendar-item-active;
            }

            &--current {
              @extend %fd-calendar-item-current;

              .#{$block}__text {
                border: $fd-calendar-item-active-inner-border;
              }
            }

            &--range {
              @extend %fd-calendar-item-range;

              &.#{$block}__item--current {
                @extend %fd-calendar-item-current;
              }
            }

            &--disabled {
              @extend %fd-calendar-item-disabled;
            }

            .#{$block}__text {
              @include fd-reset-spacing();

              height: 100%;
              display: flex;
              align-items: center;
              justify-content: center;
              border-radius: $fd-calendar-item-active-inner-border-radius;
            }
          }

          @include special-days($fd-calendar-special-days);
        }
      }
    }
  }

  &__close-button {
    @include fd-icon("decline", "m");

    display: none;
  }

  &--compact {
    width: $fd-calendar-width-compact;
    padding: $fd-calendar-padding-compact;

    .#{$block} {
      &__content {
        .#{$block}__table {
          .#{$block}__group {
            .#{$block}__row {
              .#{$block}__item {
                height: $fd-calendar-item-height-compact;
              }
            }
          }
        }

        .#{$block}--months,
        .#{$block}--years {
          padding-top: $fd-calendar-item-height-compact;
        }
      }
    }
  }

  &--mobile {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 1;

    .#{$block} {
      @media (orientation: landscape) {
        &__header {
          .#{$block}__navigation {
            justify-content: space-between;
          }

          .#{$block}__close-button {
            margin-left: 10%;
            display: block;
          }
        }
      }
    }
  }
}
